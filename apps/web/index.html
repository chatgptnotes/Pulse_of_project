<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Real-time project intelligence that keeps your finger on the pulse of progress" />
    <meta name="theme-color" content="#4F46E5" />
    <title>PulseOfProject - Feel the Heartbeat of Your Projects</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cabin:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  </head>
  <body class="font-inter">
    <div id="root"></div>

    <!-- Emergency localStorage cleanup script - runs BEFORE React loads -->
    <script>
      (function() {
        try {
          console.log('üîç Pre-React localStorage cleanup starting...');

          // Get all localStorage keys
          const keys = Object.keys(localStorage);
          const projectKeys = keys.filter(key => key.startsWith('project-'));

          console.log(`Found ${projectKeys.length} project keys in localStorage`);

          // Validate each project data
          projectKeys.forEach(key => {
            if (key.endsWith('-data')) {
              try {
                const data = localStorage.getItem(key);
                if (data) {
                  const parsed = JSON.parse(data);

                  // Basic validation
                  if (!parsed || typeof parsed !== 'object') {
                    console.warn(`‚ö†Ô∏è Removing corrupted key: ${key} (not an object)`);
                    localStorage.removeItem(key);
                    return;
                  }

                  // Check required fields
                  if (!parsed.milestones || !Array.isArray(parsed.milestones)) {
                    console.warn(`‚ö†Ô∏è Removing corrupted key: ${key} (missing/invalid milestones)`);
                    localStorage.removeItem(key);
                    return;
                  }

                  if (!parsed.tasks || !Array.isArray(parsed.tasks)) {
                    console.warn(`‚ö†Ô∏è Removing corrupted key: ${key} (missing/invalid tasks)`);
                    localStorage.removeItem(key);
                    return;
                  }

                  console.log(`‚úÖ Validated ${key}`);
                }
              } catch (e) {
                console.error(`‚ùå Error validating ${key}:`, e);
                console.warn(`‚ö†Ô∏è Removing corrupted key: ${key}`);
                localStorage.removeItem(key);
              }
            }
          });

          console.log('‚úÖ Pre-React localStorage cleanup complete');
        } catch (error) {
          console.error('‚ùå Error during pre-React cleanup:', error);
        }
      })();
    </script>

    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>